<% provide(:title, "Goal ##{@goal.id} | ") %>
<section id="goal-show">
	<div class="container">
		<div class="row">
			<div class="col-sm-12">
				<h1>Goal #<%= @goal.id %></h1>
				<p class="doicons">
					<%= link_to edit_goal_path, title: 'Edit' do %><i class="fa fa-fw fa-2x fa-pencil-square-o text-warning"></i><% end %>
					<%= link_to goal_path, title: 'Delete', method: :delete, data: { confirm: "Are you sure you would like to delete Goal ##{@goal.id}?" } do %><i class="fa fa-fw fa-2x fa-trash-o text-danger"></i><% end %>
				</p>
				<div class="row">
					<div class="col-sm-4">
						<p><strong>Time Period:</strong> <%= @goal.timeperiod %></p>
						<p><strong>Start Date:</strong> <%= @goal.startdate %></p>
						<p><strong>End Date:</strong> <%= @goal.enddate %></p>
						<p><strong>Status:</strong> <%= @goal.status %></p>
					</div>
					<div class="col-sm-4">
						<p><strong>Type:</strong> <%= @goal.goaltype %></p>
						<p><strong>Amount:</strong> <%= number_to_currency(@goal.amount, { :negative_format => '(%n)' }) %></p>
						<% if @goal.status == 'Current' or @goal.status == 'Past' %><p><strong>Actual:</strong> <%= number_to_currency(@goal.actualamount, { :negative_format => '(%n)' }) %></p><% end %>
					</div>
					<div class="col-sm-4">
						<% if @goal.status == 'Past' %>
						<p>
							<strong>Met?</strong>
							<% if @goal.met %>
							<i class="fa fa-check green"></i>
							<% else %>
							<span class="red"><strong>&times;</strong></span>
							<% end %>
						</p>
						<% elsif @goal.status == 'Current' %>
						<p><strong>Goal Pace:</strong> <%= percentageDisplay(@goal.paceAsFraction) %></p>
						<p><strong>Actual Progress:</strong> <%= percentageDisplay(@goal.actualProgressAsFraction) %></p>
						<% elsif @goal.status == 'Future' %>
						<p><strong>Actual Progress:</strong> &mdash;</p>
						<% end %>
						<% if @goal.status == 'Current' %>
							<%= progressbarDisplay %>
						<% end %>
					</div>
				</div>
			</div>
			<div class="col-sm-12">
				<h3>Paid Invoices</h3>
				<% if @goal.invoicesPaidInTimeScope.blank? %>
				<p class="lead">No paid invoices.</p>
				<% else %>
				<table class="table table-condensed">
					<thead>
						<tr>
							<th>Client</th>
							<th>Issue Date</th>
							<th>Paid Date</th>
							<th class="text-center hidden-xs">Type</th>
							<th class="text-right">Cost</th>
							<th class="text-center">Paid?</th>
						</tr>
					</thead>
					<tbody>
						<% @goal.invoicesPaidInTimeScope.each do |invoice| %>
						<tr id="invoicerow<%= invoice.id %>">
							<td><%= link_to invoice.client do %><%= invoice.client.name %><% end %></td>
							<td><%= link_to invoice do %><%= invoice.date %><% end %></td>
							<td><%= invoice.paiddate %></td>
							<td class="text-center hidden-xs"><%= invoice.worktype %></td>
							<td class="text-right"><% if invoice.cost %><%= number_to_currency(invoice.cost, { :negative_format => '(%n)' }) %><% else %>&mdash;<% end %></td>
							<td class="text-center"><% if invoice.paid == true %><i class="fa fa-check green"></i><% else %><span class="spread red">Not Paid</span><% end %></td>
						</tr>
						<% end %>
					</tbody>
				</table>
				<% end %>
			</div>
		</div>
		<div class="row hidden-print">
			<div class="col-sm-12">
				<p><%= link_to 'Back', goals_path %></p>
			</div>
		</div>
	</div>
</section>
