<%= form_for @invoice do |f| %>
	<% if @invoice.errors.any? %>
	<div id="error_explanation">
		<h2><%= pluralize(@invoice.errors.count, "error") %> prohibited this invoice from being saved:</h2>
		<ul>
			<% @invoice.errors.full_messages.each do |msg| %>
			<li><%= msg %></li>
			<% end %>
		</ul>
	</div>
	<% end %>
	<div class="row">
		<div class="col-sm-6">
			<div class="row">
				<div class="col-sm-12">
					<div class="form-group">
						<%= f.label :client_id, 'Client' %>
						<%= collection_select(:invoice, 'client_id', Client.all, :id, :name, { :include_blank => true, :selected => params[:action] == 'edit' ? @invoice.client.id : (params[:client_id].present? ? params[:client_id] : (@copied_invoice ? @copied_invoice.client.id : '')) }, { :class => 'form-control' }) %>
						<script>
						$('invoice_client_id').change();
						</script>
					</div>
				</div>
				<div class="col-sm-6">
					<div class="form-group">
						<%= f.label :date, 'Invoice Date' %>
						<div class="input-group">
							<span class="input-group-addon"><%= icon('fas', 'calendar-alt') %></span>
							<%= f.text_field :date, :required => true, :placeholder => 'YYYY-MM-DD', :class => 'form-control datepicker', :value => @invoice.date ? @invoice.date : Time.now.strftime("%Y-%m-%d") %>
						</div>
					</div>
				</div>
				<div class="col-sm-6">
					<div class="form-group">
						<%= f.label :cost %>
						<div class="input-group">
							<span class="input-group-addon"><%= icon('fas', 'dollar-sign') %></span>
							<%= f.text_field :cost, :placeholder => '0.00', class: 'form-control text-right' %>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="col-sm-6">
			<div class="form-group">
				<%= f.label :worktype, 'Work Type' %><br>
				<%= radio_button('invoice', 'worktype', 'Contract', { checked: (params[:action] == 'edit' and @invoice.worktype == 'Contract') ? true : ((@copied_invoice and @copied_invoice.worktype == 'Contract') ? true : false) }) %>
				<%= label_tag(:invoice_worktype_contract, 'Contract') %>
				<%= radio_button('invoice', 'worktype', 'Hourly', { checked: (params[:action] == 'edit' and @invoice.worktype == 'Hourly') ? true : ((@copied_invoice and @copied_invoice.worktype == 'Hourly') ? true : false) }) %>
				<%= label_tag(:invoice_worktype_hourly, 'Hourly') %>
			</div>
			<div class="form-group">
				<%= f.label :description %>
				<div class="description-prefills"><a href="#" data-slug="yesterday">Yesterday</a> | <a href="#" data-slug="today">Today</a></div>
				<% if @copied_invoice %>
				<%= f.text_area :description, class: 'form-control', value: @copied_invoice.description %>
				<% elsif @invoice.description.blank? %>
				<%= f.text_area :description, class: 'form-control', value: 'This invoice represents work through ' + 1.day.ago.strftime("%Y-%m-%d") + '.' %>
				<% else %>
				<%= f.text_area :description, class: 'form-control' %>
				<% end %>
			</div>
		</div>
	</div>
	<hr>
	<div class="row">
		<div class="col-lg-2 col-sm-6">
			<div class="form-group">
				<%= f.label :paid, 'Paid Status' %><br>
				<%= radio_button('invoice', 'paid', true) %>
				<%= label_tag(:invoice_paid_true, 'Paid') %>
				<% unless @invoice.paid %>
				<%= radio_button('invoice', 'paid', false, :checked => 'checked') %>
				<% else %>
				<%= radio_button('invoice', 'paid', false) %>
				<% end %>
				<%= label_tag(:invoice_paid_false, 'Not Paid') %>
			</div>
		</div>
		<div class="col-lg-2 col-sm-6">
			<div class="form-group">
				<%= f.label :paiddate, 'Paid Date' %>
				<div class="input-group">
					<span id="paid-date-icon-wrap" class="input-group-addon"><%= icon('fas', 'calendar-alt', id: 'paid-date-icon') %></span>
					<%= f.text_field :paiddate, :placeholder => 'YYYY-MM-DD', class: 'form-control datepicker' %>
				</div>
			</div>
		</div>
		<div class="col-lg-2 col-sm-6">
			<div class="form-group">
				<%= f.label :paymenttype, 'Payment Type' %>
				<%= select(:invoice, 'paymenttype', payment_types, { :include_blank => 'None', :selected => @copied_invoice ? @copied_invoice.paymenttype : (params[:client_id].present? ? Client.find(params[:client_id]).preferred_paymenttype : '') }, { :class => 'form-control' }) %>
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<div class="form-group">
				<button type="submit" class="btn btn-success"><%= icon('far', 'save', class: 'left') %>Save</button>
			</div>
		</div>
	</div>
<% end %>
