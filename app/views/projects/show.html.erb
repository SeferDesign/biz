<% provide(:title, "Project ##{@project.id} | ") %>
<section id="project-show">
	<div class="container">
		<div class="row">
			<div class="col-sm-12">
				<% if !@project.client.logo.blank? %>
				<%= image_tag(@project.client.logo.url(), class: 'client-logo pull-right hidden-xs') %>
				<% end %>
				<h1><%= @project.name %></h1>
				<p class="doicons">
					<%= link_to edit_project_path(@project), title: 'Edit' do %><%= icon_action_edit %><% end %>
					<%= link_to project_path(@project), title: 'Delete', method: :delete, data: { confirm: "Are you sure you would like to delete Project ##{@project.id}?" } do %><%= icon_action_delete %><% end %>
				</p>
					<strong>Project ID:</strong>
					<%= @project.id %>
				</p>
				<p>
					<strong>Client:</strong>
					<%= link_to @project.client do %><%= @project.client.name %><% end %>
				</p>
				<p>
					<strong>Completed?:</strong>
					<% if @project.completed == true %><%= icon('fas', 'check', class: 'green') %><% else %><span class="spread red">Not Completed</span><% end %>
				</p>
				<% if !@project.startdate.blank? %>
				<p>
					<strong>Start Date:</strong>
					<%= @project.startdate %>
				</p>
				<% end %>
				<% if !@project.enddate.blank? %>
				<p>
					<strong>End Date:</strong>
					<%= @project.enddate %>
				</p>
				<% end %>
			</div>
		</div>
		<div class="row">
			<div class="col-sm-8">
				<h3>Invoices</h3>
				<p><%= link_to new_invoice_path(:client_id => @project.client.id, :project_id => @project.id), :class => 'btn btn-success btn-sm' do %><%= icon('fas', 'plus', class: 'left') %>New Invoice<% end %></p>
				<% if @project.invoices.blank? %>
				<p class="lead">No invoices.</p>
				<% else %>
				<table class="table table-hover table-striped table-condensed">
					<thead>
						<tr>
							<th>Date</th>
							<th class="text-right">Cost</th>
							<th class="text-center">Paid?</th>
						</tr>
					</thead>
					<tbody>
						<% @project.invoices.each do |invoice| %>
						<tr id="invoicerow<%= invoice.id %>">
							<td><%= link_to invoice do %><%= invoice.date %><% end %></td>
							<td class="currency text-right"><% if invoice.cost %><%= number_to_currency(invoice.cost, { :negative_format => '(%n)' }) %><% else %>&mdash;<% end %></td>
							<td class="text-center"><% if invoice.paid == true %><%= icon('fas', 'check', class: 'green') %><% else %><span class="spread red">Not Paid</span><% end %></td>
						</tr>
						<% end %>
						<tr>
							<td class="text-right"><strong>Total</strong></td>
							<td class="currency text-right"><strong><%= number_to_currency(@project.invoiceTotal, { :negative_format => '(%n)' }) %></strong></td>
							<td>&nbsp;</td>
						</tr>
					</tbody>
				</table>
				<% end %>
			</div>
		</div>
		<div class="row">
			<div class="col-sm-12">
				<p><%= link_to 'Back', projects_path %></p>
			</div>
		</div>
	</div>
</section>
